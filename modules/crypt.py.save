from subprocess import Popen, PIPE

ECHO = "/bin/echo"
ENCFS = "/usr/local/bin/encfs"

def encrypt(password, crypt, path):
	print "Encrypting..."
	p1 = Popen([ECHO, "-e", "\"p\n%s\n\"" % password], stdout=PIPE)
	p2 = Popen([ENCFS, "-S", crypt,\
						   path], stdin=p1.stdout, stdout=PIPE)
	p2.communicate()[0]
	if p2.poll() is not 0:
		raise Exception('Bad Password!')
z


import conceal

data = conceal.Data()
folders = data.folders
folders.clean()
password = "123qwerty"
crypt = "/tmp/hello"

#Crypt
if crypt not in folders.li:
	folder = conceal.Folder(crypt)
	conceal.Manage(folder).crypt(password)

# Mount
if crypt not in folders.li:
	folder = folders.get(crypt)
	conceal.Manage(folder).mount(password)
	folders.update(folder)

