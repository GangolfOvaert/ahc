Настройка Apache

Apache может работать с одним из трех доступных мультипроцессорных модулей (mpm):
    prefork — один процесс на запрос, наиболее часто используемый модуль;
    worker — несколько процессов с несколькими нитями у каждого;
    event — новый экспериментальный вариант стандартного worker мультипроцессорного модуля.

Для просмотра информации о модулях выполните:
# apache2 -l

В секции <IfModule [мультипроцессорный модуль]>,
    например, <IfModule prefork.c> установим следующие значения:
StartServers 5
MinSpareServers 10
MaxSpareServers 10
MaxClients 30
ServerLimit 30

StartServers — количество запускаемых процессов.
MinSpareServers — минимальное количество простаивающих процессов.
MaxSpareServers — максимальное количество простаивающих процессов.
MaxClients — лимит процессов.
ServerLimit — устанавливается аналогичным значению MaxClients.

Обстоятельно необходимо подходить к расчету MaxClients, т.к. при установке
малого значения может увеличиться количество отказов вэб-сервера в
обслуживании на запрос клиента. Установка слишком большого значения может
привести к свопингу и значительному увеличению времени ответа вэб-сервера.

При использовании одноуровневой и двухуровневой конфигурации вэб-сервера
лимиты устанавливаются по-разному. Отдавая сформированные страницы более
легкому вэб-серверу (например, nginx), лимиты можно понизить. Конкретные
значения рассчитываются индивидуально для каждого вэб-сервера.

KeepAlive
При запросе страницы с вэб-сервера, браузер отправляет множество запросов на
загрузку CSS-стилей, изображений и т.п. Использование KeepAlive позволяет
запросить страницу и сопутствующие ей файлы в течение одного соединения.

Включаем KeepAlive, для этого строку KeepAlive Off заменяем на KeepAlive On.
MaxKeepAliveRequests установим в значение 100.
KeepAliveTimeout наиболее часто устанавливается в диапазоне 2 — 10.
Рекомендуем установить 5 секунд.

Примечание:
    Если требуется SSL доступ, то выполняем команду:
        # ahc -m install -s apache2_ssl
